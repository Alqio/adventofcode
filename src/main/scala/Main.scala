package main

object Main extends App {
  val numbersAsString = "+13\n-12\n-14\n+19\n-13\n+16\n+12\n+19\n+8\n-10\n-9\n-2\n+1\n-13\n+10\n-7\n-11\n-10\n+1\n-14\n-15\n+16\n+6\n+17\n-19\n-13\n+5\n-19\n-12\n-10\n-12\n+13\n+14\n+3\n-13\n+3\n+17\n+10\n-16\n+19\n+1\n+11\n-16\n+3\n-16\n-12\n-7\n-11\n-6\n-19\n+6\n+12\n+15\n-7\n-18\n+13\n-4\n-14\n-7\n-18\n+17\n+9\n-12\n-3\n-13\n-16\n+14\n-4\n-12\n-10\n-3\n+8\n-10\n-4\n-10\n-11\n-14\n+11\n-7\n+17\n+19\n+2\n-13\n+17\n-10\n-6\n+15\n+7\n+15\n-3\n-7\n-6\n-1\n-13\n-5\n-6\n-6\n-12\n-18\n-7\n-19\n-5\n-15\n-7\n+4\n-18\n+5\n+17\n-2\n-12\n-1\n+3\n-11\n+10\n-13\n+10\n+17\n+15\n+16\n+16\n-7\n-17\n-11\n+10\n-15\n-13\n+2\n-6\n+3\n+9\n+2\n+20\n-14\n+22\n+6\n+14\n-3\n-15\n-7\n-16\n-2\n-20\n+3\n-21\n-13\n-14\n+3\n+17\n-18\n-14\n+13\n-11\n+14\n+18\n-16\n-17\n-5\n-3\n+10\n+2\n-14\n+18\n-3\n-8\n-14\n-10\n-5\n+11\n-15\n-3\n+1\n-17\n+7\n+17\n-15\n-17\n+19\n-15\n+12\n-10\n-16\n-13\n-5\n-6\n+4\n-3\n+11\n-15\n-16\n+3\n+14\n+9\n+6\n+14\n-5\n+1\n+16\n-3\n+9\n-14\n+6\n-17\n-12\n-13\n-2\n-4\n-19\n-9\n+17\n-18\n+9\n-5\n-14\n-14\n+18\n+19\n-16\n-13\n-3\n-1\n+6\n+6\n-10\n-3\n-4\n+21\n+10\n+6\n+4\n+23\n+17\n-13\n+15\n-3\n+13\n+4\n+11\n+17\n+8\n-1\n+10\n-15\n-8\n+1\n+14\n+13\n-7\n-11\n+9\n+17\n-11\n+7\n+18\n+17\n+3\n+5\n-13\n+4\n-13\n-4\n-22\n+14\n-24\n+3\n+26\n+19\n+20\n+4\n-12\n+11\n+2\n-12\n-6\n-20\n+9\n+2\n+10\n-4\n-10\n-20\n-5\n-5\n+8\n-7\n-27\n-16\n+6\n-12\n-16\n+6\n-20\n-14\n-8\n-12\n-18\n-19\n+3\n-16\n+3\n+1\n-16\n+11\n-1\n-4\n-16\n+4\n-6\n-7\n-12\n-9\n+15\n-3\n-4\n-10\n+15\n+10\n-7\n+9\n+6\n-4\n+2\n+20\n-14\n+18\n+11\n-6\n+1\n+1\n+1\n-13\n-7\n+3\n-12\n+11\n-17\n-9\n-12\n-1\n-8\n-16\n-1\n-14\n-6\n+18\n+16\n-4\n-15\n+9\n-10\n-18\n+11\n+2\n-10\n-1\n+10\n+20\n+7\n+13\n-1\n+14\n+18\n+16\n-7\n+22\n+11\n+13\n+6\n-9\n-8\n+14\n-20\n+18\n-15\n-16\n-1\n+12\n+12\n+12\n-20\n+38\n-10\n+17\n-4\n+21\n+12\n-19\n-12\n+4\n+20\n+16\n+14\n+12\n+16\n-9\n-17\n-13\n-7\n-16\n-24\n-9\n+2\n+1\n+7\n-13\n-48\n-15\n-3\n+6\n-21\n-10\n+8\n-20\n-16\n-4\n+13\n+15\n-11\n+19\n-43\n+10\n-34\n-15\n-17\n+16\n+10\n+1\n-3\n-9\n-19\n+1\n-18\n+9\n-14\n-13\n-17\n+19\n+1\n-12\n-18\n-11\n+2\n-18\n+8\n+1\n+6\n+7\n-17\n+5\n+23\n-8\n-18\n+17\n+5\n+1\n+10\n+10\n+9\n+12\n-18\n-12\n-15\n-3\n-11\n-18\n+12\n-16\n-21\n+6\n+6\n+4\n-7\n-21\n+14\n-5\n+4\n-7\n-17\n-17\n+14\n-2\n+15\n-7\n-14\n-7\n-7\n-2\n-6\n+10\n-9\n-20\n+15\n+17\n+8\n+16\n-2\n-4\n+10\n+8\n+3\n-27\n+14\n-20\n+4\n-24\n-14\n-2\n+22\n+21\n-17\n-21\n+6\n-8\n-25\n-12\n+19\n-14\n-4\n-9\n-7\n-40\n-30\n+37\n+51\n-84\n-56\n-14\n+35\n+12\n-123\n-18\n+14\n-71\n-35\n-18\n+1\n-11\n+15\n-13\n-12\n-19\n-16\n+14\n+6\n-17\n-11\n-18\n+92\n-24\n+10\n-22\n+16\n-22\n+3\n-21\n+2\n+30\n+31\n+8\n-2\n+1\n+19\n-23\n+7\n-112\n-15\n-16\n+10\n-15\n-49\n+43\n+7\n+250\n-39\n-80\n+1324\n+76538\n+17\n-3\n+4\n+76\n+35\n+12\n-33\n+52\n+37\n-33\n+26\n+60\n-5\n+12\n+25\n-18\n+17\n+9\n+19\n-7\n+3\n-4\n-8\n+11\n-9\n+20\n+18\n+6\n-15\n+2\n+17\n+4\n+5\n-7\n-14\n-10\n-2\n-7\n+6\n+22\n-18\n+15\n-10\n+5\n-3\n-18\n+24\n+1\n+18\n+14\n+21\n-11\n-20\n+6\n-16\n+9\n-11\n-29\n-21\n-17\n+13\n+14\n-9\n+45\n+61\n+9\n+5\n-11\n+13\n+17\n+3\n+17\n-6\n-8\n-19\n+2\n-16\n-1\n-1\n-17\n+9\n+15\n-22\n-4\n+5\n+17\n-9\n+19\n+21\n-6\n+5\n+17\n-4\n-7\n+8\n-23\n-18\n-18\n+10\n+19\n+9\n-17\n-18\n-25\n+4\n+8\n+6\n-30\n+67\n-17\n+38\n+23\n+1\n-10\n+14\n+6\n+9\n+10\n-18\n+4\n+12\n+14\n+2\n+3\n+20\n-15\n+16\n+4\n-19\n+6\n+11\n+15\n+17\n+9\n+16\n-12\n-6\n+16\n+18\n+5\n+5\n-1\n-12\n+2\n+15\n+14\n+5\n-3\n+12\n+4\n+12\n-6\n+8\n+17\n+9\n-5\n+14\n-7\n+4\n+6\n+6\n+8\n+11\n-7\n+1\n-17\n-13\n+6\n+12\n-9\n+15\n-1\n+9\n-16\n-2\n+8\n+17\n-2\n+9\n+15\n-7\n+11\n-5\n-10\n+16\n-11\n-13\n+14\n+12\n+17\n+10\n-11\n-17\n-18\n+10\n+13\n+10\n+15\n-6\n+18\n-13\n-13\n+9\n-11\n+18\n+1\n+1\n-14\n+7\n+13\n+7\n+15\n+5\n+11\n+17\n+11\n-13\n-9\n-8\n-10\n-5\n+2\n+19\n+12\n-11\n+9\n-11\n+15\n-5\n+14\n+18\n+7\n+21\n+9\n+14\n-7\n+9\n-7\n-21\n-16\n-22\n-12\n+19\n-2\n+12\n+14\n+15\n+23\n+2\n+6\n-9\n-16\n+27\n-17\n+10\n+19\n-15\n+8\n+15\n-2\n-4\n+8\n+17\n+1\n+12\n-4\n-3\n-12\n-31\n-1\n-13\n-4\n-15\n+5\n+20\n+10\n-5\n-22\n-9\n-22\n-15\n-6\n+23\n-30\n-17\n-10\n-20\n-2\n-4\n-13\n+12\n-3\n+5\n-9\n-11\n+1\n-5\n-19\n-17\n+7\n+19\n+5\n+12\n-15\n+14\n+2\n-17\n-13\n+2\n-15\n+14\n-20\n-24\n+8\n+10\n-20\n-12\n-17\n-5\n-2\n-18\n-14\n-18\n+2\n+19\n+12\n-18\n+4\n+19\n+15\n-2\n-7\n-8\n-12\n+16\n-15\n-13\n-7\n-19\n+2\n-14\n+11\n-15\n-17\n+18\n-2\n-8\n-20\n-4\n+5\n+16\n+4\n+14\n+19\n-2\n-13\n+23\n-9\n+13\n+4\n-7\n-13\n-4\n-8\n+4\n-8\n+17\n-2\n-18\n-12\n-12\n+11\n-3\n-11\n+4\n+5\n-23\n+20\n+6\n-13\n-5\n-16\n-7\n+6\n+10\n-15\n+7\n+6\n-12\n+17\n-9\n-23\n+6\n+11\n-6\n-9\n+20\n-19\n+2\n-1\n+21\n+5\n-18\n+23\n+17\n+8\n+3\n+15\n+3\n-76719"

  val numbers = numbersAsString.split('\n').map(_.toInt)
  //numbers.foreach(println)

  val ar = Array(7, 7, -2, -7, -4)

  println("result: " + day1(numbers))

  def day1(numbers: Array[Int]): Int = {
    val freqs = collection.mutable.Set[Int]()

    freqs += 0

    var i = 0
    val len = numbers.length
    var sum = 0

    println(numbers.mkString(", "))

    while (true) {
      sum += numbers(i)

      //println(freqs.mkString(","))

      if (!freqs.contains(sum)) {
        freqs += sum
      } else {
        return sum
      }
      i = (i + 1) % len
      if (i == 0) {
        println(freqs.size)
      }
    }
    sum
  }

}